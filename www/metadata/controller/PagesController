{
    "type": "controller",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "designer|userClassName": "PagesController",
        "designer|userAlias": "PagesController"
    },
    "id": "ExtBox1-ext-gen40229",
    "designerId": "b29235f7-9588-4632-b7ab-b0f2633b21ec",
    "cn": [
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "pageSiteSelect",
                "fn": "pageSiteSelect",
                "implHandler": [
                    "Ext.getStore(\"PagesDataStore\").getProxy().extraParams.filter=\"[{\\\"property\\\":\\\"site\\\",\\\"value\\\":\\\"\"+records[0].get(\"id\")+\"\\\"}]\";\r",
                    "Ext.getStore(\"PagesDataStore\").load();\r",
                    "Ext.getStore(\"MasksComboStore\").getProxy().extraParams.filter=\"[{\\\"property\\\":\\\"site\\\",\\\"value\\\":\\\"\"+records[0].get(\"id\")+\"\\\"}]\";\r",
                    "Ext.getStore(\"MasksComboStore\").load();\r",
                    "var filArianne = combo.up().up().up().getDockedComponent('filArianne');\r",
                    "var typeFil = filArianne.getComponent('type');\r",
                    "if (Ext.isDefined(typeFil)) {typeFil.setText(records[0].get(\"text\"));}\r",
                    "else { typeFil= Ext.widget('button',{iconCls: \"masque-icon\", text:records[0].get(\"text\"), itemId:'type'});\r",
                    "typeFil.on(\"click\", function(){Ext.getCmp(\"mainPageTree\").getSelectionModel().select(Ext.getCmp(\"mainPageTree\").getRootNode());});\r",
                    "filArianne.add(typeFil);\r",
                    "}\r",
                    "Ext.getCmp(\"addPageBtn\").enable();\r",
                    "Ext.getCmp(\"removePageBtn\").disable();\r",
                    "Ext.Array.forEach(Ext.getCmp(\"contributionPages\").getComponent(\"contextBar\").query(\"buttongroup\"), function(btn){btn.disable();});\r",
                    "Ext.getCmp(\"mainPageEdition\").removeAll();"
                ],
                "name": "select",
                "scope": "me",
                "designer|targetType": "Ext.form.field.ComboBox",
                "designer|controlQuery": "#pagesSitesCombo"
            },
            "designerId": "7f866395-6912-493e-b496-40113840a82e"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "openPageAddWindow",
                "fn": "openPageAddWindow",
                "implHandler": [
                    "Ext.widget(\"newPageWindow\").show();"
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "#addPageBtn"
            },
            "designerId": "cb9367d6-8b6d-41dd-a7d1-4a4ad74d5b92"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "createNewPage",
                "fn": "createNewPage",
                "implHandler": [
                    "var form=button.up().getForm();\r",
                    "var target=Ext.getCmp(\"mainPageTree\").getSelectionModel().getLastSelected();\r",
                    "if (form.isValid()){\r",
                    "    var newRows=button.previousSibling().getStore().findRecord(\"id\",button.previousSibling().getValue()).get(\"rows\");\r",
                    "    var newPage=form.getValues();\r",
                    "    newPage.rows=newRows;\r",
                    "    newPage.leaf=true;\r",
                    "    newPage.iconCls=\"masque-icon\";\r",
                    "    newPage.site=Ext.getCmp(\"pagesSitesCombo\").getValue();\r",
                    "    var store=Ext.getCmp(\"mainPageTree\").getStore();\r",
                    "    store.suspendAutoSync();\r",
                    "    target.appendChild(newPage);\r",
                    "    target.set(\"leaf\",false);\r",
                    "    target.expand();\r",
                    "    store.resumeAutoSync();\r",
                    "    store.sync();\r",
                    "    button.up().up().close();\r",
                    "}"
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "#newPageSubmitBtn"
            },
            "designerId": "58437311-2357-4c3b-99f1-a0fa5762da47"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "deletePage",
                "fn": "deletePage",
                "implHandler": [
                    "var target=Ext.getCmp(\"mainPageTree\").getSelectionModel().getLastSelected();\r",
                    "if (Ext.isDefined(target)) {\r",
                    "    var delCon = Ext.widget('delConfirmZ');\r",
                    "    delCon.show();\r",
                    "    var store=Ext.getCmp(\"mainPageTree\").getStore();\r",
                    "    Ext.getCmp('delConfirmZOui').on('click', function() { \r",
                    "        store.suspendAutoSync();\r",
                    "        var myParent=target.parentNode;\r",
                    "        if ((myParent.childNodes.length==1)&&(!myParent.isRoot())){\r",
                    "            myParent.set(\"leaf\",true);\r",
                    "        }\r",
                    "        target.remove();\r",
                    "        store.resumeAutoSync();\r",
                    "        store.sync();\r",
                    "        Ext.getCmp(\"addPageBtn\").enable();\r",
                    "        Ext.getCmp(\"removePageBtn\").disable();\r",
                    "        Ext.Array.forEach(Ext.getCmp(\"contributionPages\").getComponent(\"contextBar\").query(\"buttongroup\"), function(btn){btn.disable();});\r",
                    "        Ext.getCmp(\"mainPageEdition\").removeAll();\r",
                    "        Ext.getCmp('delConfirmZ').close();\r",
                    "\r",
                    "    });  \r",
                    "\r",
                    "}"
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "#removePageBtn"
            },
            "designerId": "054b6624-59d6-425e-8c55-a8dc5ed95e57"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "pageSelect",
                "fn": "pageSelect",
                "implHandler": [
                    "if (!record.isRoot()){\r",
                    "    Ext.getCmp(\"removePageBtn\").enable();\r",
                    "    Ext.Array.forEach(Ext.getCmp(\"contributionPages\").getComponent(\"contextBar\").query(\"buttongroup\"), function(btn){btn.enable();});\r",
                    "    Ext.getCmp(\"mainPageEdition\").removeAll();\r",
                    "    Rubedo.controller.MasqueController.prototype.masqueRestit(record.get(\"rows\"),1,Ext.getCmp(\"mainPageEdition\"));\r",
                    "}"
                ],
                "name": "select",
                "scope": "me",
                "designer|targetType": "Ext.tree.Panel",
                "designer|controlQuery": "#mainPageTree"
            },
            "designerId": "16f72b7e-ea83-4f98-97e0-5e5f729e2d85"
        }
    ]
}