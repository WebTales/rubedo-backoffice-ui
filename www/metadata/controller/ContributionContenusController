{
    "type": "controller",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "designer|userClassName": "ContributionContenusController",
        "models": [
            "contenusDataModel"
        ],
        "stores": [
            "ContenusDataJson"
        ],
        "views": [
            "AjouterContenu"
        ]
    },
    "id": "ExtBox1-ext-gen29010",
    "designerId": "d27eb48c-e6bd-435b-8697-8ff50047fcac",
    "cn": [
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "typeSelect",
                "fn": "typeSelect",
                "implHandler": [
                    "var filArianne = Ext.getCmp(\"TypesContenusGrid\").findParentByType('window').getDockedComponent('filArianne');\r",
                    "var typeFil = filArianne.getComponent('type');\r",
                    "if (Ext.isDefined(typeFil)) {typeFil.setText(record.data.type);}\r",
                    "else { typeFil= Ext.widget('button',{iconCls: \"folder\", text:record.data.type, itemId:'type'});\r",
                    "filArianne.add(typeFil);\r",
                    "}\r",
                    "\r",
                    "Ext.getCmp(\"ContenusGrid\").filterBar.clearFilters();\r",
                    "\r",
                    "Ext.Array.forEach(Ext.getCmp(\"contributionContenus\").getComponent(\"contextBar\").query(\"buttongroup\"), function(btn){btn.enable();});\r",
                    "Ext.getCmp(\"ajoutPanierContenus\").disable();\r",
                    "Ext.getCmp(\"boutonSupprimerContenu\").disable();\r",
                    "Ext.getCmp(\"boutonModifierContenu\").disable();\r",
                    "Ext.getCmp(\"boutonCopierContenus\").disable();\r",
                    "Ext.getCmp(\"contribWorkflowBox\").disable();\r",
                    "var  customMeta = record.get(\"type\");\r",
                    "var imageMeta = Ext.getCmp('contributionContenus').getDockedComponent('barreMeta').getComponent('imageBarreMeta');\r",
                    "imageMeta.setSrc('resources/icones/'+MyPrefData.iconsDir+'/48x48/folder.png');  \r",
                    "var boiteMeta = Ext.getCmp(\"contributionContenus\").getDockedComponent('barreMeta').getComponent('boiteBarreMeta');\r",
                    "boiteMeta.update(customMeta);\r",
                    "var myDependantTypes= [ ];\r",
                    "Ext.Array.forEach(record.get(\"dependantTypes\"), function(someType){\r",
                    "myDependantTypes.push(Ext.getStore(\"DepTypesForContents\").findRecord(\"id\",someType));\r",
                    "});\r",
                    "Ext.getStore(\"DepContentsCombo\").removeAll();\r",
                    "Ext.getStore(\"DepContentsCombo\").loadData(myDependantTypes);"
                ],
                "name": "select",
                "scope": "me",
                "designer|targetType": "Ext.grid.View",
                "designer|controlQuery": "#TypesContenusGrid"
            },
            "designerId": "0466eea6-c776-4c88-b14e-95220a71766a"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "contentSaveAndPublish",
                "fn": "contentSaveAndPublish",
                "implHandler": [
                    "if (button.specialMode){\r",
                    "\r",
                    "    if (Ext.getCmp(\"boiteAChampsContenus\").getForm().isValid()){\r",
                    "        var champs=Ext.getCmp(\"boiteAChampsContenus\").getForm().getValues();\r",
                    "        champs.text=Ext.getCmp(Ext.getCmp('pageElementIdField').getValue()).title;\r",
                    "        champs.summary=\"\";\r",
                    "        if (button.isUpdate) {\r",
                    "            var myRec =Ext.getStore(\"CurrentContent\").getRange()[0];\r",
                    "            myRec.beginEdit();\r",
                    "            myRec.set(\"text\",champs.text);\r",
                    "            myRec.set(\"champs\",champs);\r",
                    "            myRec.endEdit();\r",
                    "            Ext.getStore(\"CurrentContent\").removeAll();\r",
                    "            Ext.getStore('TaxonomyForC2').removeAll();\r",
                    "            Ext.getStore(\"ContentTypesForContent\").removeAll();\r",
                    "            Ext.getStore(\"DepContentsCombo2\").removeAll();\r",
                    "            Ext.getStore('NestedContentsStore').removeAll();\r",
                    "            Ext.getCmp('ajouterContenu').close();\r",
                    "\r",
                    "        } else{\r",
                    "            Ext.getStore(\"CurrentContent\").removeAll();\r",
                    "            var nContenu = Ext.create('Rubedo.model.contenusDataModel', {\r",
                    "                text: champs.text,\r",
                    "                champs: champs,\r",
                    "                online:true,\r",
                    "                taxonomie:[ ],\r",
                    "                status: \"published\",\r",
                    "                pageId: Ext.getCmp(\"mainPageTree\").getSelectionModel().getLastSelected().get(\"id\"),\r",
                    "                blockId:Ext.getCmp('pageElementIdField').getValue(),\r",
                    "                typeId: Ext.getStore(\"ContentTypesForContent2\").getRange()[0].get(\"id\")\r",
                    "\r",
                    "            });\r",
                    "\r",
                    "            Ext.getStore(\"CurrentContent\").add(nContenu);   \r",
                    "            Ext.getStore(\"CurrentContent\").addListener(\"datachanged\",function(){\r",
                    "                Ext.getCmp(button.targetedId).setValue(nContenu.get(\"id\"));\r",
                    "                Ext.getStore(\"ContentTypesForContent2\").removeAll();\r",
                    "                Ext.getStore(\"CurrentContent\").removeAll();\r",
                    "                Ext.getCmp('ajouterContenu').close();\r",
                    "            },this,{single:true});\r",
                    "\r",
                    "            }\r",
                    "\r",
                    "        }\r",
                    "    } else{\r",
                    "        this.nContenuRecorder('published',button.isUpdate);\r",
                    "    }"
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "#boutonPublierNouveauContenu"
            },
            "designerId": "0be12317-77a9-4e12-adae-fbd3e1286d46"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "contentSave",
                "fn": "contentSave",
                "implHandler": [
                    "this.nContenuRecorder('draft', button.isUpdate);"
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "#boutonEnregistrerNouveauContenu"
            },
            "designerId": "43982057-d428-4c80-892d-67f635c19e58"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "putNestedContentsOffline",
                "fn": "putNestedContentsOffline",
                "implHandler": [
                    "var myStore = Ext.getCmp(\"NestedContentsGrid\").getStore();\r",
                    "myStore.suspendAutoSync();\r",
                    "Ext.Array.forEach(Ext.getCmp(\"NestedContentsGrid\").getSelectionModel().getSelection(), function(nesC){\r",
                    "    nesC.set(\"online\", false);\r",
                    "});\r",
                    "myStore.resumeAutoSync();\r",
                    "myStore.sync();"
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "#nestedContentsOfflineBtn"
            },
            "designerId": "87d8077d-4130-4766-b7fe-4ed15619aff3"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "nestedContentsSelect",
                "fn": "nestedContentsSelect",
                "implHandler": [
                    "if (Ext.isEmpty(selections)){\r",
                    "    Ext.getCmp(\"nestedContentsDeleteBtn\").disable();\r",
                    "    Ext.getCmp(\"nestedContentsModifyBtn\").disable();\r",
                    "    Ext.getCmp(\"nestedContentsOnlineBtn\").disable();\r",
                    "    Ext.getCmp(\"nestedContentsOfflineBtn\").disable();\r",
                    "} else if (selections.length==1) {\r",
                    "    Ext.getCmp(\"nestedContentsDeleteBtn\").enable();\r",
                    "    Ext.getCmp(\"nestedContentsModifyBtn\").enable();\r",
                    "    if (selections[0].get(\"online\")){\r",
                    "        Ext.getCmp(\"nestedContentsOnlineBtn\").disable();\r",
                    "        Ext.getCmp(\"nestedContentsOfflineBtn\").enable();\r",
                    "    } else {\r",
                    "        Ext.getCmp(\"nestedContentsOnlineBtn\").enable();\r",
                    "        Ext.getCmp(\"nestedContentsOfflineBtn\").disable();\r",
                    "    }\r",
                    "} else {\r",
                    "    Ext.getCmp(\"nestedContentsModifyBtn\").disable();\r",
                    "    Ext.getCmp(\"nestedContentsDeleteBtn\").enable();    \r",
                    "    var onlines = [];\r",
                    "    Ext.Array.forEach(selections, function(someContent){\r",
                    "        Ext.Array.include(onlines, someContent.get(\"online\"));\r",
                    "    });\r",
                    "    if (onlines.length>1) {\r",
                    "        Ext.getCmp(\"nestedContentsOnlineBtn\").disable();\r",
                    "        Ext.getCmp(\"nestedContentsOfflineBtn\").disable();        \r",
                    "    } else {\r",
                    "        if (onlines[0]) {\r",
                    "            Ext.getCmp(\"nestedContentsOnlineBtn\").disable();\r",
                    "        } else {\r",
                    "            Ext.getCmp(\"nestedContentsOfflineBtn\").disable();\r",
                    "        }}\r",
                    "    }"
                ],
                "name": "selectionchange",
                "scope": "me",
                "designer|targetType": "Ext.grid.Panel",
                "designer|controlQuery": "#NestedContentsGrid"
            },
            "designerId": "7c34508b-b7bf-46cc-9bbd-67b7260dcd4f"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "onWindowBeforeClose",
                "fn": "onWindowBeforeClose",
                "implHandler": [
                    "if (panel.isXType(\"window\")){\r",
                    "    Ext.getStore(\"TaxonomyForC\").removeAll();\r",
                    "    Ext.getStore(\"DepContentsCombo\").removeAll();\r",
                    "    Ext.getStore(\"NestedContentsStore\").removeAll();\r",
                    "    Ext.getStore(\"ContenusDataJson\").removeAll();\r",
                    "    Ext.getStore(\"DepTypesForContents\").removeAll();\r",
                    "    Ext.getStore(\"TypesContenusNDepDataJson\").removeAll();\r",
                    "}"
                ],
                "name": "beforeclose",
                "scope": "me",
                "designer|targetType": "Ext.window.Window",
                "designer|controlQuery": "#contributionContenus"
            },
            "designerId": "22ca2295-8f59-4e36-acb8-122494e04a8b"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "nContenuRecorder",
                "fn": "nContenuRecorder",
                "designer|params": [
                    "status",
                    "update"
                ],
                "implHandler": [
                    "if ((Ext.getCmp(\"boiteAChampsContenus\").getForm().isValid())&&(Ext.getCmp(\"boiteATaxoContenus\").getForm().isValid())&&(Ext.getCmp(\"contentMetadataBox\").getForm().isValid())){\r",
                    "    var champs=Ext.getCmp(\"boiteAChampsContenus\").getForm().getValues();\r",
                    "    var taxonomie =Ext.getCmp(\"boiteATaxoContenus\").getForm().getValues();\r",
                    "    var droits = Ext.getCmp(\"boiteADroitsContenus\").getForm().getValues();\r",
                    "    var metaData = Ext.getCmp(\"contentMetadataBox\").getForm().getValues();\r",
                    "    if (update) {\r",
                    "        var myRec =Ext.getStore(\"CurrentContent\").getRange()[0];\r",
                    "        myRec.beginEdit();\r",
                    "        myRec.set(\"text\",champs.text);\r",
                    "        myRec.set(\"champs\",champs);\r",
                    "        myRec.set(\"taxonomie\",taxonomie);\r",
                    "        myRec.set(\"status\",status);\r",
                    "        myRec.set(metaData);\r",
                    "        myRec.set(droits);\r",
                    "        myRec.endEdit();\r",
                    "        Ext.getStore(\"CurrentContent\").removeAll();\r",
                    "        Ext.getStore('TaxonomyForC2').removeAll();\r",
                    "        Ext.getStore(\"ContentTypesForContent\").removeAll();\r",
                    "        Ext.getStore(\"DepContentsCombo2\").removeAll();\r",
                    "        Ext.getStore('NestedContentsStore').removeAll();\r",
                    "\r",
                    "    } \r",
                    "    else {\r",
                    "        var nContenu = Ext.create('Rubedo.model.contenusDataModel', {\r",
                    "            text: champs.text,\r",
                    "            champs: champs,\r",
                    "            taxonomie:taxonomie,\r",
                    "            online:true,\r",
                    "            status: status,\r",
                    "            typeId: Ext.getCmp('TypesContenusGridView').getSelectionModel().getLastSelected().get(\"id\")\r",
                    "\r",
                    "        });\r",
                    "        nContenu.set(metaData);\r",
                    "        nContenu.set(droits);\r",
                    "\r",
                    "        Ext.getCmp('ContenusGrid').getStore().add(nContenu);\r",
                    "    }\r",
                    "    Ext.getCmp('ajouterContenu').close();\r",
                    "}"
                ]
            },
            "designerId": "ae3d7d9c-194f-4fdd-b848-335bc618dcb5"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "contentDelete",
                "fn": "contentDelete",
                "implHandler": [
                    "var cible = Ext.getCmp('ContenusGrid').getSelectionModel().getSelection();\r",
                    "if (Ext.isDefined(cible)) {\r",
                    "    var fenetre = Ext.widget('delConfirmZ');\r",
                    "    fenetre.show();\r",
                    "    Ext.getCmp('delConfirmZOui').on('click', function() { \r",
                    "\r",
                    "        Ext.getCmp('delConfirmZ').close();\r",
                    "        this.getContenusDataJsonStore().remove(cible);\r",
                    "\r",
                    "    }, this);  \r",
                    "\r",
                    "}"
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "#boutonSupprimerContenu"
            },
            "designerId": "1e8e3da9-d15d-4ff8-ae22-5814e4e23120"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "contentEdit",
                "fn": "contentEdit",
                "implHandler": [
                    "var cible = Ext.getCmp('ContenusGrid').getSelectionModel().getSelection()[0];\r",
                    "this.unitaryContentEdit(cible.get(\"id\"));\r",
                    "/*\r",
                    "Ext.getCmp(\"boutonAjouterContenu\").fireEvent(\"click\");\r",
                    "Ext.getCmp('boiteAChampsContenus').getForm().setValues(cible.get(\"champs\"));\r",
                    "Ext.Object.each(cible.get(\"champs\"), function(key, value, myself){\r",
                    "if (Ext.isArray(value)) {\r",
                    "var multiField=Ext.getCmp('boiteAChampsContenus').query('[name='+key+']')[0];\r",
                    "var y=0;\r",
                    "if (multiField.multivalued) {\r",
                    "Ext.Array.each(value,function(val,index){\r",
                    "if (index>0) {\r",
                    "multiField.up().getComponent('boutonReplicateurChamps').fireEvent(\"click\",multiField.up().getComponent('boutonReplicateurChamps'));\r",
                    "}\r",
                    "Ext.getCmp('boiteAChampsContenus').query('[name='+key+']')[index].setValue(val);\r",
                    "}); \r",
                    "}\r",
                    "}\r",
                    "});\r",
                    "\r",
                    "Ext.getCmp(\"boiteATaxoContenus\").getForm().setValues(cible.get(\"taxonomie\"));\r",
                    "Ext.getCmp(\"contentMetadataBox\").getForm().loadRecord(cible);\r",
                    "Ext.getCmp(\"boutonEnregistrerNouveauContenu\").isUpdate=true;\r",
                    "Ext.getCmp(\"boutonPublierNouveauContenu\").isUpdate=true;\r",
                    "Ext.getCmp(\"boutonSoumettreNouveauContenu\").isUpdate=true;\r",
                    "Ext.getCmp('ajouterContenu').setTitle(\"Modifier un contenu\");\r",
                    "if (button.restricedRead){\r",
                    "Ext.Array.forEach(Ext.getCmp(\"ajouterContenu\").query(\"field\"), function(thing){thing.setReadOnly(true);})\r",
                    "Ext.getCmp(\"boutonSoumettreNouveauContenu\").up().hide();\r",
                    "var nct = Ext.getCmp(\"nestedContentsTab\");\r",
                    "if (!Ext.isEmpty(nct)){\r",
                    "Ext.getCmp('nestedContensTabConfig').destroy();\r",
                    "nct.destroy();        \r",
                    "}\r",
                    "} else {\r",
                    "var myId=cible.get(\"id\");\r",
                    "\r",
                    "var nct = Ext.getCmp(\"nestedContentsTab\");\r",
                    "if (!Ext.isEmpty(nct)){\r",
                    "if (Ext.isEmpty(myId)){\r",
                    "Ext.getCmp('nestedContensTabConfig').destroy();\r",
                    "nct.destroy();\r",
                    "} else {\r",
                    "Ext.getStore('NestedContentsStore').removeAll();\r",
                    "Ext.getStore('NestedContentsStore').getProxy().extraParams.parentId=myId;\r",
                    "Ext.getStore('NestedContentsStore').load();\r",
                    "}\r",
                    "}\r",
                    "}*/"
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "#boutonModifierContenu"
            },
            "designerId": "d1d6b138-ff4c-43ec-bf21-9b2632472cf9"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "contentsSelect",
                "fn": "contentsSelect",
                "implHandler": [
                    "Ext.getCmp(\"boutonModifierContenu\").setText('Modifier');\r",
                    "Ext.getCmp(\"boutonModifierContenu\").restricedRead=false;\r",
                    "//console.log(Ext.getCmp(\"boutonModifierContenu\").restricedRead);\r",
                    "var boiteMeta = Ext.getCmp(\"contributionContenus\").getDockedComponent('barreMeta').getComponent('boiteBarreMeta');\r",
                    "var imageMeta = Ext.getCmp('contributionContenus').getDockedComponent('barreMeta').getComponent('imageBarreMeta');\r",
                    "var customMeta= \"\";\r",
                    "if (selections.length===0) {\r",
                    "    Ext.getCmp(\"ajoutPanierContenus\").disable();\r",
                    "    Ext.getCmp(\"boutonSupprimerContenu\").disable();\r",
                    "    Ext.getCmp(\"boutonModifierContenu\").disable();\r",
                    "    Ext.getCmp(\"boutonCopierContenus\").disable();\r",
                    "    Ext.getCmp(\"contribWorkflowBox\").disable();\r",
                    "    customMeta = Ext.getCmp('TypesContenusGrid').getSelectionModel().getLastSelected().data.type;\r",
                    "    imageMeta.setSrc('resources/icones/'+MyPrefData.iconsDir+'/48x48/folder.png');    \r",
                    "\r",
                    "} else if (selections.length==1) {\r",
                    "    Ext.getCmp(\"ajoutPanierContenus\").enable();\r",
                    "    Ext.getCmp(\"boutonCopierContenus\").enable();\r",
                    "    if ((!selections[0].get(\"readOnly\"))&&(ACL.interfaceRights[\"write.ui.contents.\"+selections[0].get(\"status\")])){\r",
                    "        Ext.getCmp(\"boutonModifierContenu\").enable();\r",
                    "        Ext.getCmp(\"boutonSupprimerContenu\").enable();\r",
                    "    }else if (ACL.interfaceRights[\"read.ui.contents.\"+selections[0].get(\"status\")]){\r",
                    "        Ext.getCmp(\"boutonModifierContenu\").enable();\r",
                    "        Ext.getCmp(\"boutonModifierContenu\").setText('Afficher');\r",
                    "        Ext.getCmp(\"boutonModifierContenu\").enable();\r",
                    "        Ext.getCmp(\"boutonSupprimerContenu\").disable();        \r",
                    "    } else {\r",
                    "        Ext.getCmp(\"boutonModifierContenu\").disable();\r",
                    "        Ext.getCmp(\"boutonSupprimerContenu\").disable();\r",
                    "    }\r",
                    "\r",
                    "    Ext.getCmp(\"contribWorkflowBox\").enable();\r",
                    "    Ext.Array.forEach(Ext.getCmp(\"contribWorkflowBox\").items.items, function(item){item.enable();});    \r",
                    "    customMeta=selections[0].get(\"text\")+\"</br> Creation : \"+Ext.Date.format(selections[0].get(\"createTime\"), \"d-m-y\")+\r",
                    "    \" Dernière modification : \"+Ext.Date.format(selections[0].get(\"lastUpdateTime\"), \"d-m-y\")+\" Auteur : \"+selections[0].get(\"createUser\").fullName;\r",
                    "    boiteMeta.update(customMeta);\r",
                    "    if (selections[0].get(\"online\")) {\r",
                    "        Ext.getCmp(\"contentOnlineBtn\").disable();\r",
                    "    } else {\r",
                    "        Ext.getCmp(\"contentOfflineBtn\").disable();\r",
                    "    }\r",
                    "    if (selections[0].get(\"status\")==\"published\") {\r",
                    "        imageMeta.setSrc('resources/icones/'+MyPrefData.iconsDir+'/48x48/page_accept.png');\r",
                    "        Ext.getCmp(\"contentAcceptPublishBtn\").disable();\r",
                    "        Ext.getCmp(\"contentSubmitValBtn\").disable();\r",
                    "        Ext.getCmp(\"contentRefuseBtn\").disable();\r",
                    "\r",
                    "    } else if (selections[0].get(\"status\")==\"pending\") {\r",
                    "        imageMeta.setSrc('resources/icones/'+MyPrefData.iconsDir+'/48x48/page_process.png');\r",
                    "        Ext.getCmp(\"contentSubmitValBtn\").disable();\r",
                    "    } else if (selections[0].get(\"status\")==\"draft\") {\r",
                    "        imageMeta.setSrc('resources/icones/'+MyPrefData.iconsDir+'/48x48/page_edit.png');\r",
                    "        if (!Ext.getCmp(\"contentSubmitValBtn\").isVisible()) {\r",
                    "            Ext.getCmp(\"contentAcceptPublishBtn\").disable();\r",
                    "        }\r",
                    "        Ext.getCmp(\"contentRefuseBtn\").disable();\r",
                    "    } else {\r",
                    "        imageMeta.setSrc('resources/icones/'+MyPrefData.iconsDir+'/48x48/page_full.png');\r",
                    "    }\r",
                    "    if (selections[0].get(\"readOnly\")){\r",
                    "        Ext.getCmp(\"contribWorkflowBox\").disable();\r",
                    "    }\r",
                    "\r",
                    "\r",
                    "} else {\r",
                    "    Ext.getCmp(\"ajoutPanierContenus\").enable();\r",
                    "    Ext.getCmp(\"boutonSupprimerContenu\").enable();\r",
                    "    Ext.getCmp(\"boutonModifierContenu\").disable();\r",
                    "    Ext.getCmp(\"boutonCopierContenus\").disable();\r",
                    "    Ext.getCmp(\"contribWorkflowBox\").enable();\r",
                    "    var statuses = [];\r",
                    "    var onlines = [];\r",
                    "    var RO = false;\r",
                    "    Ext.Array.forEach(selections, function(someContent){\r",
                    "        Ext.Array.include(statuses, someContent.get(\"status\"));\r",
                    "        Ext.Array.include(onlines, someContent.get(\"online\"));\r",
                    "        if (someContent.get(\"readOnly\")){\r",
                    "            RO=true;\r",
                    "        }\r",
                    "    });\r",
                    "    if (statuses.length>1){\r",
                    "        Ext.getCmp(\"contribWorkflowBox\").disable();\r",
                    "        imageMeta.setSrc('resources/icones/'+MyPrefData.iconsDir+'/48x48/page_full.png');\r",
                    "\r",
                    "    } else {\r",
                    "        Ext.Array.forEach(Ext.getCmp(\"contribWorkflowBox\").items.items, function(item){item.enable();});\r",
                    "        if (onlines.length>1) {\r",
                    "            Ext.getCmp(\"contentOnlineBtn\").disable();\r",
                    "            Ext.getCmp(\"contentOfflineBtn\").disable();\r",
                    "\r",
                    "        }else {\r",
                    "            if (onlines[0]) {\r",
                    "                Ext.getCmp(\"contentOnlineBtn\").disable();\r",
                    "            } else {\r",
                    "                Ext.getCmp(\"contentOfflineBtn\").disable();\r",
                    "            }}\r",
                    "            if (statuses[0]==\"published\") {\r",
                    "                imageMeta.setSrc('resources/icones/'+MyPrefData.iconsDir+'/48x48/page_accept.png');\r",
                    "                Ext.getCmp(\"contentAcceptPublishBtn\").disable();\r",
                    "                Ext.getCmp(\"contentSubmitValBtn\").disable();\r",
                    "                Ext.getCmp(\"contentRefuseBtn\").disable();\r",
                    "\r",
                    "            } else if (statuses[0]==\"pending\") {\r",
                    "                imageMeta.setSrc('resources/icones/'+MyPrefData.iconsDir+'/48x48/page_process.png');\r",
                    "                Ext.getCmp(\"contentSubmitValBtn\").disable();\r",
                    "\r",
                    "            } else if (statuses[0]==\"draft\") {\r",
                    "                imageMeta.setSrc('resources/icones/'+MyPrefData.iconsDir+'/48x48/page_edit.png');\r",
                    "                if (!Ext.getCmp(\"contentSubmitValBtn\").isVisible()) {\r",
                    "                    Ext.getCmp(\"contentAcceptPublishBtn\").disable();\r",
                    "                }\r",
                    "                Ext.getCmp(\"contentRefuseBtn\").disable();\r",
                    "            }\r",
                    "        }\r",
                    "        customMeta=selections.length+\" Contenus\";\r",
                    "        if (RO==true){\r",
                    "            Ext.getCmp(\"contribWorkflowBox\").disable();\r",
                    "            Ext.getCmp(\"boutonModifierContenu\").disable();\r",
                    "            Ext.getCmp(\"boutonSupprimerContenu\").disable();\r",
                    "        }\r",
                    "    }\r",
                    "\r",
                    "    boiteMeta.update(customMeta);"
                ],
                "name": "selectionchange",
                "scope": "me",
                "designer|targetType": "Ext.grid.Panel",
                "designer|controlQuery": "#ContenusGrid"
            },
            "designerId": "2af287bb-3cc0-46dd-9a77-33d9b9c7235f"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "doubleClickEdit",
                "fn": "doubleClickEdit",
                "implHandler": [
                    "//Ext.getCmp(\"boutonModifierContenu\").fireEvent(\"click\");\r",
                    "this.unitaryContentEdit(record.get(\"id\"));"
                ],
                "name": "itemdblclick",
                "scope": "me",
                "designer|targetType": "Ext.grid.Panel",
                "designer|controlQuery": "#ContenusGrid"
            },
            "designerId": "29809d19-0d43-44be-9789-cb0efb02186f"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "putContentsOnline",
                "fn": "putContentsOnline",
                "implHandler": [
                    "Ext.getStore(\"ContenusDataJson\").suspendAutoSync();\r",
                    "Ext.Array.forEach(Ext.getCmp(\"ContenusGrid\").getSelectionModel().getSelection(), function(content){\r",
                    "    \r",
                    "        content.set(\"online\", true);\r",
                    "    });\r",
                    "    Ext.getStore(\"ContenusDataJson\").resumeAutoSync();\r",
                    "    Ext.getStore(\"ContenusDataJson\").sync();"
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "#contentOnlineBtn"
            },
            "designerId": "5609cb55-a942-4612-a54f-e9f26e0decce"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "contentRefuse",
                "fn": "contentRefuse",
                "implHandler": [
                    "Ext.getStore(\"ContenusDataJson\").suspendAutoSync();\r",
                    "Ext.Array.forEach(Ext.getCmp(\"ContenusGrid\").getSelectionModel().getSelection(), function(content){\r",
                    "    if (content.get(\"status\")==\"pending\") {\r",
                    "        content.set(\"status\", \"draft\");\r",
                    "    }});\r",
                    "    Ext.getStore(\"ContenusDataJson\").resumeAutoSync();\r",
                    "    Ext.getStore(\"ContenusDataJson\").sync();"
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "#contentRefuseBtn"
            },
            "designerId": "94138a98-a78e-4bb5-ad8b-0e949321e587"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "putContentsOffline",
                "fn": "putContentsOffline",
                "implHandler": [
                    "Ext.getStore(\"ContenusDataJson\").suspendAutoSync();\r",
                    "Ext.Array.forEach(Ext.getCmp(\"ContenusGrid\").getSelectionModel().getSelection(), function(content){\r",
                    "\r",
                    "    content.set(\"online\", false);\r",
                    "});\r",
                    "Ext.getStore(\"ContenusDataJson\").resumeAutoSync();\r",
                    "Ext.getStore(\"ContenusDataJson\").sync();"
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "#contentOfflineBtn"
            },
            "designerId": "a09ba59a-d8db-44ca-8e79-c42a6a3dcb2d"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "contentSubmitVal",
                "fn": "contentSubmitVal",
                "implHandler": [
                    "Ext.getStore(\"ContenusDataJson\").suspendAutoSync();\r",
                    "Ext.Array.forEach(Ext.getCmp(\"ContenusGrid\").getSelectionModel().getSelection(), function(content){\r",
                    "    if (content.get(\"status\")==\"draft\") {\r",
                    "        content.set(\"status\", \"pending\");\r",
                    "    }});\r",
                    "    Ext.getStore(\"ContenusDataJson\").resumeAutoSync();\r",
                    "    Ext.getStore(\"ContenusDataJson\").sync();"
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "#contentSubmitValBtn"
            },
            "designerId": "eae53a4e-c7fe-4932-b8c5-bc212c9bb55c"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "contentAcceptPublish",
                "fn": "contentAcceptPublish",
                "implHandler": [
                    "Ext.getStore(\"ContenusDataJson\").suspendAutoSync();\r",
                    "Ext.Array.forEach(Ext.getCmp(\"ContenusGrid\").getSelectionModel().getSelection(), function(content){\r",
                    "\r",
                    "    content.set(\"status\", \"published\");\r",
                    "});\r",
                    "Ext.getStore(\"ContenusDataJson\").resumeAutoSync();\r",
                    "Ext.getStore(\"ContenusDataJson\").sync();"
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "#contentAcceptPublishBtn"
            },
            "designerId": "84f2a9eb-c989-4280-98ec-f1d06b70936e"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "contentSaveAndSubmit",
                "fn": "contentSaveAndSubmit",
                "implHandler": [
                    "this.nContenuRecorder('pending',button.isUpdate);"
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "#boutonSoumettreNouveauContenu"
            },
            "designerId": "b54053e6-c639-4ad5-819e-ed4b31921c1e"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "nestedContentsDelete",
                "fn": "nestedContentsDelete",
                "implHandler": [
                    "Ext.getCmp(\"NestedContentsGrid\").getStore().remove(Ext.getCmp(\"NestedContentsGrid\").getSelectionModel().getSelection());"
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "#nestedContentsDeleteBtn"
            },
            "designerId": "c3974fbb-2e52-4e6f-986a-7b7761b2adee"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "putNestedContentsOnline",
                "fn": "putNestedContentsOnline",
                "implHandler": [
                    "var myStore = Ext.getCmp(\"NestedContentsGrid\").getStore();\r",
                    "myStore.suspendAutoSync();\r",
                    "Ext.Array.forEach(Ext.getCmp(\"NestedContentsGrid\").getSelectionModel().getSelection(), function(nesC){\r",
                    "    nesC.set(\"online\", true);\r",
                    "});\r",
                    "myStore.resumeAutoSync();\r",
                    "myStore.sync();"
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "#nestedContentsOnlineBtn"
            },
            "designerId": "b6ad5fdb-bf2f-463f-834e-aa0c589df945"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "addNestedContent",
                "fn": "addNestedContent",
                "implHandler": [
                    "if (Ext.getCmp(\"nestedContentsAddCombo\").isValid()) {\r",
                    "    var myType=Ext.getCmp(\"nestedContentsAddCombo\").getStore().findRecord(\"id\",Ext.getCmp(\"nestedContentsAddCombo\").getValue());\r",
                    "    var myWindow = Ext.widget('NestedContentAddWindow');\r",
                    "    Ext.getCmp('ViewportPrimaire').add(myWindow);\r",
                    "    if (Ext.isDefined(window.innerHeight)) {\r",
                    "        if (myWindow.height>(window.innerHeight-40)) {myWindow.setHeight((window.innerHeight-40));}\r",
                    "        if (myWindow.width>(window.innerWidth)) {myWindow.setWidth((window.innerWidth));}\r",
                    "    }\r",
                    "    myWindow.show();\r",
                    "    var formulaireTC = Ext.getCmp('nestedContentsFieldBox');\r",
                    "    var champsD =myType.get(\"champs\");\r",
                    "    Ext.Array.forEach(champsD,function(donnees) {\r",
                    "        var configurateur = Ext.clone(donnees.config);\r",
                    "        if (donnees.cType =='treepicker'){ \r",
                    "            var monStore= Ext.getStore(donnees.store);\r",
                    "            configurateur.store = monStore;\r",
                    "            monStore.load();\r",
                    "        }\r",
                    "        else if (donnees.cType == 'combobox') {\r",
                    "            var monStore=  Ext.create('Ext.data.Store', Ext.clone(donnees.store));\r",
                    "            configurateur.store = monStore;\r",
                    "        }\r",
                    "        var nouvChamp = Ext.widget(donnees.cType, configurateur);\r",
                    "        nouvChamp.config=Ext.clone(donnees.config);\r",
                    "        if (donnees.cType =='triggerfield'){ \r",
                    "            var Ouvrir = Ext.clone(donnees.ouvrir);\r",
                    "            nouvChamp.onTriggerClick= function() {\r",
                    "                var fenetre = Ext.widget(Ouvrir);\r",
                    "                fenetre.showAt(screen.width/2-200, 100);\r",
                    "            } ; \r",
                    "            nouvChamp.ouvrir =Ext.clone(donnees.ouvrir);\r",
                    "        }  \r",
                    "        nouvChamp.anchor = '90%';\r",
                    "        nouvChamp.style = '{float:left;}';\r",
                    "        var enrobage =Ext.widget('ChampTC');\r",
                    "        enrobage.add(nouvChamp);\r",
                    "        enrobage.getComponent('helpBouton').setTooltip(nouvChamp.config.tooltip);\r",
                    "        if (nouvChamp.multivalued) {\r",
                    "            enrobage.add(Ext.widget('button', {iconCls: 'add',valeursM: 1, margin: '0 0 0 5', tooltip: 'Valeurs multiples', itemId: 'boutonReplicateurChamps'}));\r",
                    "\r",
                    "        };\r",
                    "        formulaireTC.add(enrobage);\r",
                    "\r",
                    "    });\r",
                    "}"
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "#nestedContentsAddBtn"
            },
            "designerId": "ccc66b9c-5a97-416f-ae83-84c635ac8e29"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "nestedContentRecorder",
                "fn": "nestedContentRecorder",
                "designer|params": [
                    "update"
                ],
                "implHandler": [
                    "if (Ext.getCmp(\"nestedContentsFieldBox\").getForm().isValid()){\r",
                    "    var fields=Ext.getCmp(\"nestedContentsFieldBox\").getForm().getValues();\r",
                    "    if (update) {\r",
                    "        var myRec =Ext.getCmp(\"NestedContentsGrid\").getSelectionModel().getSelection()[0];\r",
                    "        myRec.beginEdit();\r",
                    "        myRec.set(\"text\",fields.text);\r",
                    "        myRec.set(\"fields\",fields);\r",
                    "        myRec.endEdit();\r",
                    "\r",
                    "    } \r",
                    "    else {\r",
                    "        var nContenu = Ext.create('Rubedo.model.nestedContentModel', {\r",
                    "            text: fields.text,\r",
                    "            fields: fields,\r",
                    "            typeId: Ext.getCmp('nestedContentsAddCombo').getValue()\r",
                    "\r",
                    "        });\r",
                    "\r",
                    "        Ext.getCmp(\"NestedContentsGrid\").getStore().add(nContenu);\r",
                    "    }\r",
                    "    Ext.getCmp('NestedContentAddWindow').close();\r",
                    "}"
                ]
            },
            "designerId": "e3e4e254-cc5e-4ecf-8755-659164383223"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "saveNestedContent",
                "fn": "saveNestedContent",
                "implHandler": [
                    "this.nestedContentRecorder(button.isUpdate);"
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "#nestedContentRecordBtn"
            },
            "designerId": "9fe56c18-95bf-4c2e-a4a4-4319db241081"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "nestedContentEdit",
                "fn": "nestedContentEdit",
                "implHandler": [
                    "var cible = Ext.getCmp('NestedContentsGrid').getSelectionModel().getSelection()[0];\r",
                    "Ext.getCmp(\"nestedContentsAddCombo\").setValue(cible.get(\"typeId\"));\r",
                    "Ext.getCmp(\"nestedContentsAddBtn\").fireEvent(\"click\");\r",
                    "Ext.getCmp('nestedContentsFieldBox').getForm().setValues(cible.get(\"fields\"));\r",
                    "Ext.Object.each(cible.get(\"fields\"), function(key, value, myself){\r",
                    "    if (Ext.isArray(value)) {\r",
                    "        var multiField=Ext.getCmp('nestedContentsFieldBox').query('[name='+key+']')[0];\r",
                    "        var y=0;\r",
                    "        if (multiField.multivalued) {\r",
                    "            Ext.Array.each(value,function(val,index){\r",
                    "                if (index>0) {\r",
                    "                    multiField.up().getComponent('boutonReplicateurChamps').fireEvent(\"click\",multiField.up().getComponent('boutonReplicateurChamps'));\r",
                    "                }\r",
                    "                Ext.getCmp('nestedContentsFieldBox').query('[name='+key+']')[index].setValue(val);\r",
                    "            }); \r",
                    "        }\r",
                    "    }\r",
                    "});\r",
                    "\r",
                    "\r",
                    "Ext.getCmp(\"nestedContentRecordBtn\").isUpdate=true;\r",
                    "Ext.getCmp('ajouterContenu').setTitle(\"Modifier un contenu imbriqué\");"
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "#nestedContentsModifyBtn"
            },
            "designerId": "c95e30f7-faca-4c58-875f-27f2e815b47d"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "NCDblClickEdit",
                "fn": "NCDblClickEdit",
                "implHandler": [
                    "Ext.getCmp(\"nestedContentsModifyBtn\").fireEvent(\"click\");"
                ],
                "name": "itemdblclick",
                "scope": "me",
                "designer|targetType": "Ext.grid.Panel",
                "designer|controlQuery": "#NestedContentsGrid"
            },
            "designerId": "575594ef-2357-4a76-b58a-b2bad0120ca7"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "onWindowRender",
                "fn": "onWindowRender",
                "implHandler": [
                    "if (abstractcomponent.isXType(\"window\")){\r",
                    "    Ext.getStore(\"TaxonomyForC\").load();\r",
                    "    Ext.getStore(\"DepTypesForContents\").load();\r",
                    "    Ext.getStore(\"TypesContenusNDepDataJson\").load();\r",
                    "}"
                ],
                "name": "render",
                "scope": "me",
                "designer|targetType": "Ext.window.Window",
                "designer|controlQuery": "#contributionContenus"
            },
            "designerId": "f3285970-e0ec-4143-bcc6-6cd9ad124687"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "unitaryContentEdit",
                "fn": "unitaryContentEdit",
                "designer|params": [
                    "id",
                    "specialMode"
                ],
                "implHandler": [
                    "var me=this;\r",
                    "Ext.getStore('TaxonomyForC2').load();\r",
                    "Ext.getStore(\"CurrentContent\").getProxy().extraParams.id = id;\r",
                    "Ext.getStore(\"CurrentContent\").addListener(\"load\",function(theStore,records,successful){\r",
                    "    if (successful){\r",
                    "        var theContent = records[0];\r",
                    "        if ((!theContent.get(\"readOnly\"))&&(ACL.interfaceRights[\"write.ui.contents\"])&&(ACL.interfaceRights[\"write.ui.contents.\"+theContent.get(\"status\")])){\r",
                    "            me.prepareContext(theContent, true, specialMode);\r",
                    "        }else if ((ACL.interfaceRights[\"read.ui.contents\"])&&(ACL.interfaceRights[\"read.ui.contents.\"+theContent.get(\"status\")])){\r",
                    "            me.prepareContext(theContent, false, specialMode);\r",
                    "        } else {\r",
                    "            Ext.Msg.alert('Erreur',\"Vos droits sont insuffisants pour afficher ou modifier ce contenu\");\r",
                    "            theStore.removeAll();\r",
                    "        }\r",
                    "\r",
                    "    }\r",
                    "},this,{single:true});\r",
                    "    Ext.getStore(\"CurrentContent\").load();"
                ]
            },
            "designerId": "1ee0d45e-e7df-43f3-8cc7-65f8e71a5a7e"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "displayContentEditWindow",
                "fn": "displayContentEditWindow",
                "designer|params": [
                    "content",
                    "contentType",
                    "editMode",
                    "specialMode"
                ],
                "implHandler": [
                    "var fenetre = Ext.widget('ajouterContenu', {specialMode:specialMode});\r",
                    "Ext.getCmp('ViewportPrimaire').add(fenetre);\r",
                    "if (Ext.isDefined(window.innerHeight)) {\r",
                    "    if (fenetre.height>(window.innerHeight-40)) {fenetre.setHeight((window.innerHeight-40));}\r",
                    "    if (fenetre.width>(window.innerWidth)) {fenetre.setWidth((window.innerWidth));}\r",
                    "}\r",
                    "fenetre.show();\r",
                    "Ext.getCmp(\"nestedContentsAddCombo\").bindStore(Ext.getStore(\"DepContentsCombo2\"));\r",
                    "Ext.getStore(\"VersioningStore\").removeAll();\r",
                    "Ext.getStore(\"VersioningStore\").clearFilter(true);\r",
                    "\r",
                    "Ext.getStore(\"VersioningStore\").filter(\"contentId\",content.get(\"id\"));\r",
                    "Ext.getStore(\"VersioningStore\").filter([\r",
                    "    Ext.create('Ext.util.Filter', {property: \"contentId\", value: content.get(\"id\")}),\r",
                    "    Ext.create('Ext.util.Filter', {property:\"publishVersion\", value:{$gt:0}})\r",
                    "]);\r",
                    "\r",
                    "var formulaireTC = Ext.getCmp('boiteAChampsContenus');\r",
                    "var champsD =contentType.get(\"champs\");\r",
                    "for (g=0; g<champsD.length; g++) {\r",
                    "    var donnees=champsD[g];\r",
                    "    var configurateur = Ext.clone(donnees.config);\r",
                    "    if (donnees.cType =='treepicker'){ \r",
                    "        configurateur.store = Ext.create(\"Ext.data.TreeStore\", {\r",
                    "            isOptimised: true,\r",
                    "            usedCollection: 'Pages',\r",
                    "            autoLoad: false,\r",
                    "            autoSync: false,\r",
                    "            remoteFilter: true,\r",
                    "            model: 'Rubedo.model.taxonomyTermModel',\r",
                    "            proxy: {\r",
                    "                type: 'ajax',\r",
                    "                api: {\r",
                    "                    read: 'taxonomy-terms/navigation-tree'\r",
                    "                },\r",
                    "                reader: {\r",
                    "                    type: 'json',\r",
                    "                    getResponseData: function(response) {\r",
                    "                        var data, error;\r",
                    "\r",
                    "                        try {\r",
                    "                            data = Ext.decode(response.responseText);\r",
                    "                            if (Ext.isDefined(data.data)){data.children=data.data;}// error fix\r",
                    "                            return this.readRecords(data);\r",
                    "                        } catch (ex) {\r",
                    "                            error = new Ext.data.ResultSet({\r",
                    "                                total  : 0,\r",
                    "                                count  : 0,\r",
                    "                                records: [],\r",
                    "                                success: false,\r",
                    "                                message: ex.message\r",
                    "                            });\r",
                    "\r",
                    "                            this.fireEvent('exception', this, response, error);\r",
                    "                            console.log(ex);\r",
                    "\r",
                    "                            Ext.Logger.warn('Unable to parse the JSON returned by the server');\r",
                    "\r",
                    "                            return error;\r",
                    "                        }\r",
                    "                    },\r",
                    "                    messageProperty: 'message'\r",
                    "                }\r",
                    "            },\r",
                    "            sorters: {\r",
                    "                property: 'orderValue'\r",
                    "            }\r",
                    "        });\r",
                    "        configurateur.store.load();\r",
                    "        configurateur.valueField=\"id\";\r",
                    "        configurateur.displayField=\"text\";\r",
                    "        configurateur.plugins=[Ext.create(\"Ext.ux.form.field.ClearButton\")];\r",
                    "    }\r",
                    "    else if (donnees.cType == 'combobox') {\r",
                    "        var monStore=  Ext.create('Ext.data.Store', Ext.clone(donnees.store));\r",
                    "        configurateur.store = monStore;\r",
                    "    }\r",
                    "    //begin temporary fix\r",
                    "    configurateur.labelSeparator=\" \";\r",
                    "    //end temporary fix\r",
                    "    var nouvChamp = Ext.widget(donnees.cType, configurateur);\r",
                    "    nouvChamp.config=Ext.clone(donnees.config);\r",
                    "    //begin temporary fix\r",
                    "    if(nouvChamp.config.tooltip==\"help text\"){nouvChamp.config.tooltip=\"\";}\r",
                    "    //end temporary fix\r",
                    "    if (donnees.cType =='triggerfield'){ \r",
                    "        var Ouvrir = Ext.clone(donnees.ouvrir);\r",
                    "        nouvChamp.onTriggerClick= function() {\r",
                    "            var fenetre = Ext.widget(Ouvrir);\r",
                    "            fenetre.showAt(screen.width/2-200, 100);\r",
                    "        } ; \r",
                    "        nouvChamp.ouvrir =Ext.clone(donnees.ouvrir);\r",
                    "    }  \r",
                    "    nouvChamp.anchor = '90%';\r",
                    "    nouvChamp.style = '{float:left;}';\r",
                    "    var enrobage =Ext.widget('ChampTC');\r",
                    "    enrobage.add(nouvChamp);\r",
                    "    enrobage.getComponent('helpBouton').setTooltip(nouvChamp.config.tooltip);\r",
                    "    if (Ext.isEmpty(nouvChamp.config.tooltip)){\r",
                    "        enrobage.getComponent('helpBouton').hidden=true;\r",
                    "    } \r",
                    "    if (nouvChamp.multivalued) {\r",
                    "        enrobage.add(Ext.widget('button', {iconCls: 'add',valeursM: 1, margin: '0 0 0 5', tooltip: 'Valeurs multiples', itemId: 'boutonReplicateurChamps'}));\r",
                    "\r",
                    "    };\r",
                    "    formulaireTC.add(enrobage);\r",
                    "\r",
                    "}\r",
                    "var formTaxoTC =  Ext.getCmp('boiteATaxoContenus');\r",
                    "var lesTaxo = contentType.get(\"vocabularies\");\r",
                    "var i=0;\r",
                    "for (i=0; i<lesTaxo.length; i++) {\r",
                    "    var leVocab = Ext.getStore('TaxonomyForC2').findRecord('id', lesTaxo[i]);\r",
                    "    var storeT = Ext.create('Ext.data.JsonStore', {\r",
                    "        model:\"Rubedo.model.taxonomyTermModel\",\r",
                    "        remoteFilter:\"true\",\r",
                    "        proxy: {\r",
                    "            type: 'ajax',\r",
                    "            api: {\r",
                    "                read: 'taxonomy-terms'\r",
                    "            },\r",
                    "            reader: {\r",
                    "                type: 'json',\r",
                    "                messageProperty: 'message',\r",
                    "                root: 'data'\r",
                    "            },\r",
                    "            encodeFilters: function(filters) {\r",
                    "                var min = [],\r",
                    "                length = filters.length,\r",
                    "                i = 0;\r",
                    "\r",
                    "                for (; i < length; i++) {\r",
                    "                    min[i] = {\r",
                    "                        property: filters[i].property,\r",
                    "                        value   : filters[i].value\r",
                    "                    };\r",
                    "                    if (filters[i].type) {\r",
                    "                        min[i].type = filters[i].type;\r",
                    "                    }\r",
                    "                    if (filters[i].operator) {\r",
                    "                        min[i].operator = filters[i].operator;\r",
                    "                    }\r",
                    "                }\r",
                    "                return this.applyEncoding(min);\r",
                    "            }\r",
                    "        },\r",
                    "        filters: {\r",
                    "            property: 'vocabularyId',\r",
                    "            value: leVocab.get(\"id\")\r",
                    "        }\r",
                    "\r",
                    "    });\r",
                    "    storeT.on(\"beforeload\", function(s,o){\r",
                    "        o.filters=Ext.Array.slice(o.filters,0,1);\r",
                    "        if (!Ext.isEmpty(o.params.comboQuery)){\r",
                    "\r",
                    "            var newFilter=Ext.create('Ext.util.Filter', {\r",
                    "                property:\"text\",\r",
                    "                value:o.params.comboQuery,\r",
                    "                operator:'like'\r",
                    "            });\r",
                    "\r",
                    "            o.filters.push(newFilter);\r",
                    "\r",
                    "        }\r",
                    "\r",
                    "\r",
                    "    });\r",
                    "\r",
                    "\r",
                    "    var selecteur = Ext.widget('comboboxselect', {\r",
                    "        name:leVocab.get(\"id\"),\r",
                    "        width:690,\r",
                    "        fieldLabel: leVocab.get(\"name\"),\r",
                    "        autoScroll: false,\r",
                    "        store: storeT,\r",
                    "        queryMode: 'remote',\r",
                    "        queryParam: 'comboQuery',\r",
                    "        minChars:3,\r",
                    "        displayField: 'text',\r",
                    "        valueField: 'id',\r",
                    "        filterPickList: true,\r",
                    "        typeAhead: true,\r",
                    "        forceSelection: !leVocab.data.expandable,\r",
                    "        createNewOnEnter: leVocab.data.expandable,\r",
                    "        multiSelect: leVocab.data.multiSelect,\r",
                    "        allowBlank: !leVocab.data.mandatory\r",
                    "    });\r",
                    "    var enrobage =Ext.widget('ChampTC');\r",
                    "    enrobage.add(selecteur);\r",
                    "    enrobage.getComponent('helpBouton').setTooltip(leVocab.data.helpText);\r",
                    "    formTaxoTC.add(enrobage);\r",
                    "\r",
                    "}\r",
                    "\r",
                    "var cible = content;\r",
                    "Ext.getCmp('boiteAChampsContenus').getForm().setValues(cible.get(\"champs\"));\r",
                    "Ext.Object.each(cible.get(\"champs\"), function(key, value, myself){\r",
                    "    if (Ext.isArray(value)) {\r",
                    "        var multiField=Ext.getCmp('boiteAChampsContenus').query('[name='+key+']')[0];\r",
                    "        var y=0;\r",
                    "        if (multiField.multivalued) {\r",
                    "            Ext.Array.each(value,function(val,index){\r",
                    "                if (index>0) {\r",
                    "                    multiField.up().getComponent('boutonReplicateurChamps').fireEvent(\"click\",multiField.up().getComponent('boutonReplicateurChamps'));\r",
                    "                }\r",
                    "                Ext.getCmp('boiteAChampsContenus').query('[name='+key+']')[index].setValue(val);\r",
                    "            }); \r",
                    "        }\r",
                    "    }\r",
                    "});\r",
                    "Ext.getCmp(\"ajouterContenu\").getComponent(0).getLayout().setActiveItem(1);\r",
                    "Ext.getCmp(\"ajouterContenu\").getComponent(0).getLayout().setActiveItem(0);\r",
                    "Ext.getCmp(\"boiteATaxoContenus\").getForm().setValues(cible.get(\"taxonomie\"));\r",
                    "Ext.getCmp(\"boiteADroitsContenus\").getForm().setValues(cible.getData());\r",
                    "Ext.getCmp(\"contentMetadataBox\").getForm().setValues(cible.getData());\r",
                    "Ext.getCmp(\"boutonEnregistrerNouveauContenu\").isUpdate=true;\r",
                    "Ext.getCmp(\"boutonPublierNouveauContenu\").isUpdate=true;\r",
                    "Ext.getCmp(\"boutonSoumettreNouveauContenu\").isUpdate=true;\r",
                    "Ext.getCmp('ajouterContenu').setTitle(content.get(\"text\"));\r",
                    "if (!editMode){\r",
                    "    if ((!content.get(\"readOnly\"))&&(ACL.interfaceRights[\"write.ui.contents\"])&&(content.get(\"status\")==\"published\")&&(ACL.interfaceRights[\"write.ui.contents.draft\"])) {\r",
                    "        Ext.getCmp(\"boutonSoumettreNouveauContenu\").hide();\r",
                    "        Ext.getCmp(\"boutonPublierNouveauContenu\").hide();\r",
                    "        var nct = Ext.getCmp(\"nestedContentsTab\");\r",
                    "        if (!Ext.isEmpty(nct)){\r",
                    "            Ext.getCmp('nestedContensTabConfig').destroy();\r",
                    "            nct.destroy(); \r",
                    "        }\r",
                    "    }\r",
                    "    else\r",
                    "    {\r",
                    "        Ext.Array.forEach(Ext.getCmp(\"ajouterContenu\").query(\"field\"), function(thing){thing.setReadOnly(true);})\r",
                    "        Ext.Array.forEach(Ext.getCmp(\"ajouterContenu\").query(\"button\"), function(truc){if (!truc.isXType(\"tab\")){truc.disable();}});\r",
                    "\r",
                    "        Ext.getCmp(\"boutonSoumettreNouveauContenu\").up().hide();\r",
                    "        var nct = Ext.getCmp(\"nestedContentsTab\");\r",
                    "        if (!Ext.isEmpty(nct)){\r",
                    "            Ext.getCmp('nestedContensTabConfig').destroy();\r",
                    "            nct.destroy(); \r",
                    "        }\r",
                    "    }\r",
                    "} else {\r",
                    "    var myId=cible.get(\"id\");\r",
                    "\r",
                    "    var nct = Ext.getCmp(\"nestedContentsTab\");\r",
                    "    if (!Ext.isEmpty(nct)){\r",
                    "        if (Ext.isEmpty(Ext.getCmp(\"nestedContentsAddCombo\").getStore().getRange())){\r",
                    "            Ext.getCmp('nestedContensTabConfig').destroy();\r",
                    "            nct.destroy();\r",
                    "\r",
                    "        } else {\r",
                    "            Ext.getStore('NestedContentsStore').removeAll();\r",
                    "            Ext.getStore('NestedContentsStore').getProxy().extraParams.parentId=myId;\r",
                    "            Ext.getStore('NestedContentsStore').load();\r",
                    "        }\r",
                    "    }\r",
                    "}\r",
                    "if (specialMode){\r",
                    "    try{\r",
                    "        var nct5 = Ext.getCmp(\"nestedContentsTab\");\r",
                    "        if (!Ext.isEmpty(nct)){\r",
                    "            Ext.getCmp('nestedContensTabConfig').destroy();\r",
                    "            nct5.destroy();\r",
                    "\r",
                    "        }\r",
                    "    } catch(err){ }\r",
                    "        var nct2 = Ext.getCmp('boiteATaxoContenus');\r",
                    "        if (!Ext.isEmpty(nct2)){\r",
                    "            Ext.getCmp('taxoTabConfig').destroy();\r",
                    "            nct2.destroy();\r",
                    "\r",
                    "        }\r",
                    "        var nct3 = Ext.getCmp(\"contentMetadataBox\");\r",
                    "        if (!Ext.isEmpty(nct3)){\r",
                    "            Ext.getCmp('metaTabConfig').destroy();\r",
                    "            nct3.destroy();\r",
                    "\r",
                    "        }\r",
                    "        var nct4 = Ext.getCmp('boiteADroitsContenus');\r",
                    "        if (!Ext.isEmpty(nct4)){\r",
                    "            Ext.getCmp('rightsTabConfig').destroy();\r",
                    "            nct4.destroy();\r",
                    "\r",
                    "        }\r",
                    "        Ext.getCmp(\"boutonEnregistrerNouveauContenu\").hide();\r",
                    "        Ext.getCmp(\"boutonSoumettreNouveauContenu\").hide();\r",
                    "        Ext.getCmp(\"boutonPublierNouveauContenu\").specialMode=true;\r",
                    "        Ext.getCmp(\"cedtr1\").destroy();\r",
                    "        Ext.getCmp(\"cedtr2\").destroy();\r",
                    "\r",
                    "\r",
                    "    }"
                ]
            },
            "designerId": "55e297cb-12c1-4ee8-a3c9-3e88f1d9caed"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "displaySpecialCreate",
                "fn": "displaySpecialCreate",
                "designer|params": [
                    "theCT",
                    "targetedId"
                ],
                "implHandler": [
                    "if (Ext.isDefined(theCT)) {\r",
                    "    var fenetre = Ext.widget('ajouterContenu', {specialMode:true});\r",
                    "    Ext.getCmp('ViewportPrimaire').add(fenetre);\r",
                    "    if (Ext.isDefined(window.innerHeight)) {\r",
                    "        if (fenetre.height>(window.innerHeight-40)) {fenetre.setHeight((window.innerHeight-40));}\r",
                    "        if (fenetre.width>(window.innerWidth)) {fenetre.setWidth((window.innerWidth));}\r",
                    "    }\r",
                    "    fenetre.show();\r",
                    "    fenetre.setTitle(\"Nouveau contenu \"+theCT.get(\"type\"));\r",
                    "    var formulaireTC = Ext.getCmp('boiteAChampsContenus');\r",
                    "    Ext.getCmp(\"contentsVersionPanel\").up().remove( Ext.getCmp(\"contentsVersionPanel\"));\r",
                    "    var champsD =theCT.data.champs;\r",
                    "    for (g=0; g<champsD.length; g++) {\r",
                    "        var donnees=champsD[g];\r",
                    "        var configurateur = Ext.clone(donnees.config);\r",
                    "        if (donnees.cType =='treepicker'){ \r",
                    "            configurateur.store = Ext.create(\"Ext.data.TreeStore\", {\r",
                    "                isOptimised: true,\r",
                    "                usedCollection: 'Pages',\r",
                    "                autoLoad: false,\r",
                    "                autoSync: false,\r",
                    "                remoteFilter: true,\r",
                    "                model: 'Rubedo.model.taxonomyTermModel',\r",
                    "                proxy: {\r",
                    "                    type: 'ajax',\r",
                    "                    api: {\r",
                    "                        read: 'taxonomy-terms/navigation-tree'\r",
                    "                    },\r",
                    "                    reader: {\r",
                    "                        type: 'json',\r",
                    "                        getResponseData: function(response) {\r",
                    "                            var data, error;\r",
                    "\r",
                    "                            try {\r",
                    "                                data = Ext.decode(response.responseText);\r",
                    "                                if (Ext.isDefined(data.data)){data.children=data.data;}// error fix\r",
                    "                                return this.readRecords(data);\r",
                    "                            } catch (ex) {\r",
                    "                                error = new Ext.data.ResultSet({\r",
                    "                                    total  : 0,\r",
                    "                                    count  : 0,\r",
                    "                                    records: [],\r",
                    "                                    success: false,\r",
                    "                                    message: ex.message\r",
                    "                                });\r",
                    "\r",
                    "                                this.fireEvent('exception', this, response, error);\r",
                    "                                console.log(ex);\r",
                    "\r",
                    "                                Ext.Logger.warn('Unable to parse the JSON returned by the server');\r",
                    "\r",
                    "                                return error;\r",
                    "                            }\r",
                    "                        },\r",
                    "                        messageProperty: 'message'\r",
                    "                    }\r",
                    "                },\r",
                    "                sorters: {\r",
                    "                    property: 'orderValue'\r",
                    "                }\r",
                    "            });\r",
                    "            configurateur.store.load();\r",
                    "            configurateur.valueField=\"id\";\r",
                    "            configurateur.displayField=\"text\";\r",
                    "        configurateur.plugins=[Ext.create(\"Ext.ux.form.field.ClearButton\")];\r",
                    "        }\r",
                    "        else if (donnees.cType == 'combobox') {\r",
                    "            var monStore=  Ext.create('Ext.data.Store', Ext.clone(donnees.store));\r",
                    "            configurateur.store = monStore;\r",
                    "        }\r",
                    "        //begin temporary fix\r",
                    "        configurateur.labelSeparator=\" \";\r",
                    "        //end temporary fix\r",
                    "        var nouvChamp = Ext.widget(donnees.cType, configurateur);\r",
                    "        nouvChamp.config=Ext.clone(donnees.config);\r",
                    "        //begin temporary fix\r",
                    "        if(nouvChamp.config.tooltip==\"help text\"){nouvChamp.config.tooltip=\"\";}\r",
                    "        //end temporary fix\r",
                    "        if (donnees.cType =='triggerfield'){ \r",
                    "            var Ouvrir = Ext.clone(donnees.openWindow);\r",
                    "            nouvChamp.onTriggerClick= function() {\r",
                    "                var fenetre = Ext.widget(Ouvrir);\r",
                    "                fenetre.showAt(screen.width/2-200, 100);\r",
                    "            } ; \r",
                    "            nouvChamp.openWindow =Ext.clone(donnees.openWindow);\r",
                    "        }  \r",
                    "        nouvChamp.anchor = '90%';\r",
                    "        nouvChamp.style = '{float:left;}';\r",
                    "        var enrobage =Ext.widget('ChampTC');\r",
                    "        enrobage.add(nouvChamp);\r",
                    "        enrobage.getComponent('helpBouton').setTooltip(nouvChamp.config.tooltip);\r",
                    "        if (Ext.isEmpty(nouvChamp.config.tooltip)){\r",
                    "            enrobage.getComponent('helpBouton').hidden=true;\r",
                    "        } \r",
                    "        if (nouvChamp.multivalued) {\r",
                    "            enrobage.add(Ext.widget('button', {iconCls: 'add',valeursM: 1, margin: '0 0 0 5', tooltip: 'Valeurs multiples', itemId: 'boutonReplicateurChamps'}));\r",
                    "\r",
                    "        };\r",
                    "        formulaireTC.add(enrobage);\r",
                    "\r",
                    "    }\r",
                    "    /*var formTaxoTC =  Ext.getCmp('boiteATaxoContenus');\r",
                    "    var lesTaxo = Ext.getCmp('TypesContenusGrid').getSelectionModel().getSelection()[0].get(\"vocabularies\");\r",
                    "    var i=0;\r",
                    "    for (i=0; i<lesTaxo.length; i++) {\r",
                    "    var leVocab = Ext.getStore('TaxonomyForC').findRecord('id', lesTaxo[i]);\r",
                    "    var storeT = Ext.create('Ext.data.JsonStore', {\r",
                    "    model:\"Rubedo.model.taxonomyTermModel\",\r",
                    "    remoteFilter:\"true\",\r",
                    "    proxy: {\r",
                    "    type: 'ajax',\r",
                    "    api: {\r",
                    "    read: 'taxonomy-terms'\r",
                    "    },\r",
                    "    reader: {\r",
                    "    type: 'json',\r",
                    "    messageProperty: 'message',\r",
                    "    root: 'data'\r",
                    "    },\r",
                    "    encodeFilters: function(filters) {\r",
                    "    var min = [],\r",
                    "    length = filters.length,\r",
                    "    i = 0;\r",
                    "\r",
                    "    for (; i < length; i++) {\r",
                    "    min[i] = {\r",
                    "    property: filters[i].property,\r",
                    "    value   : filters[i].value\r",
                    "    };\r",
                    "    if (filters[i].type) {\r",
                    "    min[i].type = filters[i].type;\r",
                    "    }\r",
                    "    if (filters[i].operator) {\r",
                    "    min[i].operator = filters[i].operator;\r",
                    "    }\r",
                    "    }\r",
                    "    return this.applyEncoding(min);\r",
                    "    }\r",
                    "    },\r",
                    "    filters: {\r",
                    "    property: 'vocabularyId',\r",
                    "    value: leVocab.get(\"id\")\r",
                    "    }\r",
                    "\r",
                    "    });\r",
                    "    storeT.on(\"beforeload\", function(s,o){\r",
                    "    o.filters=Ext.Array.slice(o.filters,0,1);\r",
                    "    if (!Ext.isEmpty(o.params.comboQuery)){\r",
                    "\r",
                    "    var newFilter=Ext.create('Ext.util.Filter', {\r",
                    "    property:\"text\",\r",
                    "    value:o.params.comboQuery,\r",
                    "    operator:'like'\r",
                    "    });\r",
                    "\r",
                    "    o.filters.push(newFilter);\r",
                    "\r",
                    "    }\r",
                    "\r",
                    "\r",
                    "    });\r",
                    "\r",
                    "\r",
                    "    var selecteur = Ext.widget('comboboxselect', {\r",
                    "    name:leVocab.get(\"id\"),\r",
                    "    width:690,\r",
                    "    fieldLabel: leVocab.get(\"name\"),\r",
                    "    autoScroll: false,\r",
                    "    store: storeT,\r",
                    "    queryMode: 'remote',\r",
                    "    queryParam: 'comboQuery',\r",
                    "    minChars:3,\r",
                    "    displayField: 'text',\r",
                    "    valueField: 'id',\r",
                    "    filterPickList: true,\r",
                    "    typeAhead: true,\r",
                    "    forceSelection: !leVocab.data.expandable,\r",
                    "    createNewOnEnter: leVocab.data.expandable,\r",
                    "    multiSelect: leVocab.data.multiSelect,\r",
                    "    allowBlank: !leVocab.data.mandatory\r",
                    "    });\r",
                    "    var enrobage =Ext.widget('ChampTC');\r",
                    "    enrobage.add(selecteur);\r",
                    "    enrobage.getComponent('helpBouton').setTooltip(leVocab.data.helpText);\r",
                    "    formTaxoTC.add(enrobage);\r",
                    "\r",
                    "    }*/\r",
                    "\r",
                    "    try{\r",
                    "        var nct = Ext.getCmp(\"nestedContentsTab\");\r",
                    "        if (!Ext.isEmpty(nct)){\r",
                    "            Ext.getCmp('nestedContensTabConfig').destroy();\r",
                    "            nct.destroy();\r",
                    "\r",
                    "        }} catch(err){ }\r",
                    "            var nct2 = Ext.getCmp('boiteATaxoContenus');\r",
                    "            if (!Ext.isEmpty(nct2)){\r",
                    "                Ext.getCmp('taxoTabConfig').destroy();\r",
                    "                nct2.destroy();\r",
                    "\r",
                    "            }\r",
                    "            var nct3 = Ext.getCmp(\"contentMetadataBox\");\r",
                    "            if (!Ext.isEmpty(nct3)){\r",
                    "                Ext.getCmp('metaTabConfig').destroy();\r",
                    "                nct3.destroy();\r",
                    "\r",
                    "            }\r",
                    "            var nct4 = Ext.getCmp('boiteADroitsContenus');\r",
                    "            if (!Ext.isEmpty(nct4)){\r",
                    "                Ext.getCmp('rightsTabConfig').destroy();\r",
                    "                nct4.destroy();\r",
                    "\r",
                    "            }\r",
                    "            Ext.getCmp(\"boutonEnregistrerNouveauContenu\").hide();\r",
                    "            Ext.getCmp(\"boutonSoumettreNouveauContenu\").hide();\r",
                    "            Ext.getCmp(\"boutonPublierNouveauContenu\").specialMode=true;\r",
                    "            Ext.getCmp(\"boutonPublierNouveauContenu\").targetedId=targetedId;\r",
                    "            Ext.getCmp(\"cedtr1\").destroy();\r",
                    "            Ext.getCmp(\"cedtr2\").destroy();\r",
                    "\r",
                    "\r",
                    "        }"
                ]
            },
            "designerId": "59b973fd-a6b3-49da-80bd-9719b3b8177b"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "prepareContext",
                "fn": "prepareContext",
                "designer|params": [
                    "content",
                    "editMode",
                    "specialMode"
                ],
                "implHandler": [
                    "var me=this;\r",
                    "Ext.getStore(\"ContentTypesForContent\").addListener(\"load\",function(theStore,records,successful){\r",
                    "    if (successful){\r",
                    "        var myContentType=theStore.findRecord(\"id\",content.get(\"typeId\"));\r",
                    "        if (editMode){\r",
                    "            var myDependantTypes= [ ];\r",
                    "            Ext.Array.forEach(myContentType.get(\"dependantTypes\"), function(someType){\r",
                    "                myDependantTypes.push(theStore.findRecord(\"id\",someType));\r",
                    "            });\r",
                    "            Ext.getStore(\"DepContentsCombo2\").removeAll();\r",
                    "            Ext.getStore(\"DepContentsCombo2\").loadData(myDependantTypes);\r",
                    "        }\r",
                    "        me.displayContentEditWindow(content, myContentType,editMode, specialMode);\r",
                    "\r",
                    "    }\r",
                    "},this,{single:true});\r",
                    "    Ext.getStore(\"ContentTypesForContent\").load();"
                ]
            },
            "designerId": "61545fb7-19f6-474e-99b3-0961085bf6c9"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "specialContentCreate",
                "fn": "specialContentCreate",
                "designer|params": [
                    "CTType",
                    "targetedId"
                ],
                "implHandler": [
                    "var me=this;\r",
                    "Ext.getStore(\"ContentTypesForContent2\").getProxy().extraParams.filter=\"[{\\\"property\\\":\\\"CTType\\\",\\\"value\\\":\\\"\"+CTType+\"\\\"}]\";\r",
                    "Ext.getStore(\"ContentTypesForContent2\").addListener(\"load\",function(theStore,records,successful){\r",
                    "    if (successful){\r",
                    "        var theCT = records[0];\r",
                    "        me.displaySpecialCreate(theCT,targetedId);\r",
                    "\r",
                    "\r",
                    "    }\r",
                    "},this,{single:true});\r",
                    "    Ext.getStore(\"ContentTypesForContent2\").load();"
                ]
            },
            "designerId": "d60e78f1-db2e-4a49-acc3-f879e61fd8cf"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "onPageContentGridItemDblClick",
                "fn": "onPageContentGridItemDblClick",
                "implHandler": [
                    "this.unitaryContentEdit(record.get(\"id\"), false);"
                ],
                "name": "itemdblclick",
                "scope": "me",
                "designer|targetType": "Ext.grid.Panel",
                "designer|controlQuery": "#pageContentGrid"
            },
            "designerId": "6d5500da-cac3-42e7-a9ef-15e77f8be732"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "onBoutonCopierContenusClick",
                "fn": "onBoutonCopierContenusClick",
                "implHandler": [
                    "var copiedOne = Ext.getCmp(\"ContenusGrid\").getSelectionModel().getLastSelected().copy();\r",
                    "Ext.data.Model.id(copiedOne);\r",
                    "copiedOne.data.champs.text=copiedOne.get(\"text\")+\" - Copie du \"+Ext.Date.format(new Date(), 'j F, Y, G:i');\r",
                    "copiedOne.set(\"status\", \"draft\");\r",
                    "copiedOne.set(\"text\",copiedOne.get(\"text\")+\" - Copie du \"+Ext.Date.format(new Date(), 'j F, Y, G:i'));\r",
                    "Ext.getCmp(\"ContenusGrid\").getStore().add(copiedOne);"
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "#boutonCopierContenus"
            },
            "designerId": "1babab45-9945-4020-b722-3be3ee752bfb"
        }
    ]
}