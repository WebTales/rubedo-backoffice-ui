{
    "type": "controller",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "designer|userClassName": "ContributionContenusController",
        "models": [
            "contenusDataModel"
        ],
        "stores": [
            "ContenusDataJson"
        ],
        "views": [
            "AjouterContenu"
        ]
    },
    "id": "ExtBox1-ext-gen29010",
    "designerId": "d27eb48c-e6bd-435b-8697-8ff50047fcac",
    "cn": [
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "typeSelect",
                "fn": "typeSelect",
                "implHandler": [
                    "var filArianne = Ext.getCmp(\"TypesContenusGrid\").findParentByType('window').getDockedComponent('filArianne');\r",
                    "var typeFil = filArianne.getComponent('type');\r",
                    "if (Ext.isDefined(typeFil)) {typeFil.setText(record.data.type);}\r",
                    "else { typeFil= Ext.widget('button',{iconCls: \"folder\", text:record.data.type, itemId:'type'});\r",
                    "filArianne.add(typeFil);\r",
                    "}\r",
                    "this.getContenusDataJsonStore().loadData(record.get(\"contenus\"));\r",
                    "Ext.Array.forEach(Ext.getCmp(\"contributionContenus\").getComponent(\"contextBar\").query(\"buttongroup\"), function(btn){btn.enable();});\r",
                    "Ext.getCmp(\"ajoutPanierContenus\").disable();\r",
                    "Ext.getCmp(\"boutonSupprimerContenu\").disable();\r",
                    "Ext.getCmp(\"boutonModifierContenu\").disable();\r",
                    "Ext.getCmp(\"boutonCopierContenus\").disable();\r",
                    "var  customMeta = record.get(\"type\");\r",
                    "var imageMeta = Ext.getCmp('contributionContenus').getDockedComponent('barreMeta').getComponent('imageBarreMeta');\r",
                    "imageMeta.setSrc('resources/icones/'+MyPrefData.iconsDir+'/48x48/folder.png');  \r",
                    "var boiteMeta = Ext.getCmp(\"contributionContenus\").getDockedComponent('barreMeta').getComponent('boiteBarreMeta');\r",
                    "boiteMeta.update(customMeta);"
                ],
                "name": "select",
                "scope": "me",
                "designer|targetType": "Ext.grid.View",
                "designer|controlQuery": "#TypesContenusGrid"
            },
            "designerId": "0466eea6-c776-4c88-b14e-95220a71766a"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "contentSaveAndPublish",
                "fn": "contentSaveAndPublish",
                "implHandler": [
                    "this.nContenuRecorder('publié');"
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "#boutonPublierNouveauContenu"
            },
            "designerId": "0be12317-77a9-4e12-adae-fbd3e1286d46"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "contentSave",
                "fn": "contentSave",
                "implHandler": [
                    "this.nContenuRecorder('brouillon');"
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "#boutonEnregistrerNouveauContenu"
            },
            "designerId": "43982057-d428-4c80-892d-67f635c19e58"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "nContenuRecorder",
                "fn": "nContenuRecorder",
                "designer|params": [
                    "etat"
                ],
                "implHandler": [
                    "/*\r",
                    "var formC = Ext.getCmp('boiteAChampsContenus').items.items;\r",
                    "for (m=0;  m<formC.length; m++) {\r",
                    "    if((formC[m].getComponent(0).isXType('field'))&&(!formC[m].getComponent(0).isValid())){\r",
                    "        return(false);\r",
                    "    }\r",
                    "}\r",
                    "var champs = [ ];\r",
                    "for (k=1; k<formC.length; k++) {\r",
                    "    if (formC[k].getComponent(0).isXType('field')) {\r",
                    "        var champ= {nom : formC[k].getComponent(0).name, value: formC[k].getComponent(0).getValue()};\r",
                    "        champs.push(champ);\r",
                    "    }\r",
                    "}\r",
                    "*/\r",
                    "if (Ext.getCmp(\"boiteAChampsContenus\").getForm().isValid()){\r",
                    "    var champs=Ext.getCmp(\"boiteAChampsContenus\").getForm().getValues();\r",
                    "    var nContenu = Ext.create('model.contenusDataModel', {\r",
                    "        text: champs.text,\r",
                    "        champs: champs,\r",
                    "        etat: etat,\r",
                    "        type: Ext.getCmp('TypesContenusGridView').getSelectionModel().getLastSelected().data.type,\r",
                    "        auteur: MyPrefData.myName\r",
                    "    });\r",
                    "    \r",
                    "    Ext.getCmp('ContenusGrid').getStore().add(nContenu);\r",
                    "    Ext.getCmp('TypesContenusGridView').getSelectionModel().getLastSelected().data.contenus.push(nContenu.data);//remove after server sync operational\r",
                    "    \r",
                    "    Ext.getCmp('ajouterContenu').close();\r",
                    "    console.log(nContenu);\r",
                    "}"
                ]
            },
            "designerId": "ae3d7d9c-194f-4fdd-b848-335bc618dcb5"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "contentDelete",
                "fn": "contentDelete",
                "implHandler": [
                    "var cible = Ext.getCmp('ContenusGrid').getSelectionModel().getSelection();\r",
                    "this.getContenusDataJsonStore().remove(cible);"
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "#boutonSupprimerContenu"
            },
            "designerId": "1e8e3da9-d15d-4ff8-ae22-5814e4e23120"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "onButtonClick3",
                "fn": "onButtonClick3",
                "implHandler": [
                    "var cible = Ext.getCmp('ContenusGrid').getSelectionModel().getSelection()[0];\r",
                    "Ext.getCmp(\"boutonAjouterContenu\").fireEvent(\"click\");\r",
                    "Ext.getCmp('boiteAChampsContenus').getForm().setValues(cible.get(\"champs\"));"
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "#boutonModifierContenu"
            },
            "designerId": "d1d6b138-ff4c-43ec-bf21-9b2632472cf9"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "contentsSelect",
                "fn": "contentsSelect",
                "implHandler": [
                    "var boiteMeta = Ext.getCmp(\"contributionContenus\").getDockedComponent('barreMeta').getComponent('boiteBarreMeta');\r",
                    "var imageMeta = Ext.getCmp('contributionContenus').getDockedComponent('barreMeta').getComponent('imageBarreMeta');\r",
                    "var customMeta= \"\";\r",
                    "if (selections.length===0) {\r",
                    "    Ext.getCmp(\"ajoutPanierContenus\").disable();\r",
                    "    Ext.getCmp(\"boutonSupprimerContenu\").disable();\r",
                    "    Ext.getCmp(\"boutonModifierContenu\").disable();\r",
                    "    Ext.getCmp(\"boutonCopierContenus\").disable();\r",
                    "    customMeta = Ext.getCmp('TypesContenusGrid').getSelectionModel().getLastSelected().data.type;\r",
                    "    imageMeta.setSrc('resources/icones/'+MyPrefData.iconsDir+'/48x48/folder.png');    \r",
                    "\r",
                    "} else if (selections.length==1) {\r",
                    "    Ext.getCmp(\"ajoutPanierContenus\").enable();\r",
                    "    Ext.getCmp(\"boutonSupprimerContenu\").enable();\r",
                    "    Ext.getCmp(\"boutonModifierContenu\").enable();\r",
                    "    Ext.getCmp(\"boutonCopierContenus\").enable();\r",
                    "    customMeta=selections[0].data.text+\"</br> Creation : \"+selections[0].data.creation+\r",
                    "    \" Dernière modification : \"+selections[0].data.derniereModification+\" Version : \"+selections[0].data.version+\r",
                    "    \" Auteur : \"+selections[0].data.auteur;\r",
                    "    imageMeta.setSrc('resources/icones/'+MyPrefData.iconsDir+'/48x48/page_full.png');\r",
                    "\r",
                    "} else {\r",
                    "    Ext.getCmp(\"ajoutPanierContenus\").enable();\r",
                    "    Ext.getCmp(\"boutonSupprimerContenu\").enable();\r",
                    "    Ext.getCmp(\"boutonModifierContenu\").disable();\r",
                    "    Ext.getCmp(\"boutonCopierContenus\").disable();\r",
                    "    customMeta=selections.length+\" Contenus\";\r",
                    "    imageMeta.setSrc('resources/icones/'+MyPrefData.iconsDir+'/48x48/page_full.png');\r",
                    "\r",
                    "}\r",
                    "\r",
                    "boiteMeta.update(customMeta);"
                ],
                "name": "selectionchange",
                "scope": "me",
                "designer|targetType": "Ext.grid.Panel",
                "designer|controlQuery": "#ContenusGrid"
            },
            "designerId": "2af287bb-3cc0-46dd-9a77-33d9b9c7235f"
        }
    ]
}