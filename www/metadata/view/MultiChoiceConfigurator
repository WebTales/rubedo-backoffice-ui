{
    "type": "Ext.window.Window",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "localiserId": "multiChoiceQuestionEditor",
        "height": 404,
        "id": "MultiChoiceConfigurator",
        "width": 632,
        "designer|userClassName": "MultiChoiceConfigurator",
        "designer|userAlias": "MultiChoiceConfigurator",
        "resizable": false,
        "layout": "fit",
        "title": "Editeur de question fermée",
        "constrain": true,
        "modal": true
    },
    "configAlternates": {
        "resizable": "boolean"
    },
    "designerId": "547619b3-9e1c-4adf-a83a-d4aa14243ebe",
    "customConfigs": [
        {
            "group": "(Custom Properties)",
            "name": "localiserId",
            "type": "string"
        }
    ],
    "cn": [
        {
            "type": "Ext.toolbar.Toolbar",
            "reference": {
                "name": "dockedItems",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "dock": "bottom"
            },
            "designerId": "67e26dce-0cf6-4377-9232-f4074c7609f9",
            "cn": [
                {
                    "type": "Ext.toolbar.Fill",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "layout|flex": null
                    },
                    "designerId": "e696e82d-cbfd-4f08-990a-524843455e53"
                },
                {
                    "type": "Ext.button.Button",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "layout|flex": null,
                        "localiserId": "validateBtn",
                        "id": "MultiChoiceConfiguratorSubmit",
                        "iconCls": "ouiSpetit",
                        "text": "Valider"
                    },
                    "designerId": "627dd1bd-c39d-40a5-8d82-c65fcfcc827f",
                    "customConfigs": [
                        {
                            "group": "(Custom Properties)",
                            "name": "localiserId",
                            "type": "string"
                        }
                    ],
                    "cn": [
                        {
                            "type": "basiceventbinding",
                            "reference": {
                                "name": "listeners",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "fn": "onMultiChoiceConfiguratorSubmitClick",
                                "implHandler": [
                                    "var initialValues = Ext.clone(button.up().up().initialItemConfig);\r",
                                    "var myId = Ext.clone(button.up().up().targetedId);\r",
                                    "var form = button.up().up().getComponent(0).getForm();\r",
                                    "if (form.isValid()) {\r",
                                    "    var newData = Ext.clone(form.getFieldValues());\r",
                                    "    initialValues.fieldType=newData.fieldType;\r",
                                    "    initialValues.label=newData.fieldLabel;\r",
                                    "    initialValues.tooltip=newData.tooltip;\r",
                                    "    initialValues.qNb=newData.qNb;\r",
                                    "    delete newData.fieldType;\r",
                                    "    delete newData.fieldLabel;\r",
                                    "    delete newData.tooltip;\r",
                                    "    delete newData.qNb;\r",
                                    "    newData.vertical=true;\r",
                                    "    newData.items=Ext.Array.pluck(Ext.getStore(\"MultiChoiceOptionsStore\").getRange(), \"data\");\r",
                                    "    delete newData.answers;\r",
                                    "    initialValues.fieldConfig=newData;\r",
                                    "    Ext.getCmp(myId).itemConfig=initialValues;\r",
                                    "    button.up().up().close();\r",
                                    "    Ext.getCmp(myId).sync();\r",
                                    "}"
                                ],
                                "name": "click",
                                "scope": "me"
                            },
                            "designerId": "bca9b6fc-4363-4402-bc08-ac0ffac22176"
                        }
                    ]
                }
            ]
        },
        {
            "type": "Ext.form.Panel",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "bodyPadding": 10,
                "title": ""
            },
            "designerId": "af134271-ea20-420c-a392-f87759c39b7d",
            "cn": [
                {
                    "type": "Ext.form.field.Text",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "layout|anchor": "100%",
                        "localiserId": "questionLabelField",
                        "fieldLabel": "Intitulé de la question",
                        "labelWidth": 140,
                        "name": "fieldLabel"
                    },
                    "designerId": "4281a76e-27f2-4e96-a32f-181781ff4715",
                    "customConfigs": [
                        {
                            "group": "(Custom Properties)",
                            "name": "localiserId",
                            "type": "string"
                        }
                    ]
                },
                {
                    "type": "Ext.form.field.Text",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "layout|anchor": "100%",
                        "localiserId": "questionCodeField",
                        "fieldLabel": "Code de la question",
                        "labelWidth": 140,
                        "name": "qNb"
                    },
                    "designerId": "4dae3c30-2ddb-4d3d-a9f7-7106d4aaea3c",
                    "customConfigs": [
                        {
                            "group": "(Custom Properties)",
                            "name": "localiserId",
                            "type": "string"
                        }
                    ]
                },
                {
                    "type": "Ext.form.field.Text",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "layout|anchor": "100%",
                        "localiserId": "questionHelpTextField",
                        "fieldLabel": "Bulle d'aide",
                        "labelWidth": 140,
                        "name": "tooltip"
                    },
                    "designerId": "8543ec2e-77e3-4bb3-8a70-f64f3b9d3dcc",
                    "customConfigs": [
                        {
                            "group": "(Custom Properties)",
                            "name": "localiserId",
                            "type": "string"
                        }
                    ]
                },
                {
                    "type": "Ext.form.field.Checkbox",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "layout|anchor": "100%",
                        "localiserId": "mandatoryCheckbox",
                        "fieldLabel": "Obligatoire",
                        "labelWidth": 140,
                        "name": "mandatory",
                        "boxLabel": "",
                        "inputValue": "true",
                        "uncheckedValue": "false"
                    },
                    "designerId": "6a7e3f07-0d2a-4760-a441-b3bec3669a84",
                    "customConfigs": [
                        {
                            "group": "(Custom Properties)",
                            "name": "localiserId",
                            "type": "string"
                        }
                    ]
                },
                {
                    "type": "Ext.form.field.Number",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "layout|anchor": "100%",
                        "localiserId": "colNumberField",
                        "fieldLabel": "Nombre de colonnes",
                        "labelWidth": 140,
                        "name": "columns",
                        "allowDecimals": false,
                        "minValue": 1
                    },
                    "designerId": "6fc18692-6812-4cca-9a7e-bf5e61babac3",
                    "customConfigs": [
                        {
                            "group": "(Custom Properties)",
                            "name": "localiserId",
                            "type": "string"
                        }
                    ]
                },
                {
                    "type": "Ext.form.RadioGroup",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "localiserId": "answerTypeCheckboxGroup",
                        "fieldLabel": "Réponse",
                        "labelSeparator": " ",
                        "labelWidth": 140
                    },
                    "designerId": "20e9a0ed-1271-4d5f-a01e-6c3ac89fdc54",
                    "customConfigs": [
                        {
                            "group": "(Custom Properties)",
                            "name": "localiserId",
                            "type": "string"
                        }
                    ],
                    "cn": [
                        {
                            "type": "Ext.form.field.Radio",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "localiserId": "sipleChoiceRadio",
                                "fieldLabel": null,
                                "name": "fieldType",
                                "boxLabel": "choix simple",
                                "inputValue": "radiogroup"
                            },
                            "designerId": "cdf0777a-9f5c-4d6a-b232-05448194ab0d",
                            "customConfigs": [
                                {
                                    "group": "(Custom Properties)",
                                    "name": "localiserId",
                                    "type": "string"
                                }
                            ]
                        },
                        {
                            "type": "Ext.form.field.Radio",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "localiserId": "multiChoiceRadio",
                                "fieldLabel": null,
                                "name": "fieldType",
                                "boxLabel": "choix multiple",
                                "inputValue": "checkboxgroup"
                            },
                            "designerId": "6d9bde21-ec6c-411d-b575-05085fe8b8dd",
                            "customConfigs": [
                                {
                                    "group": "(Custom Properties)",
                                    "name": "localiserId",
                                    "type": "string"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "Ext.grid.Panel",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "height": 160,
                        "id": "formsMCCGrid",
                        "title": "",
                        "forceFit": true,
                        "store": "MultiChoiceOptionsStore"
                    },
                    "designerId": "257c43e3-d15b-4994-9d0c-8915741e361a",
                    "cn": [
                        {
                            "type": "Ext.grid.View",
                            "reference": {
                                "name": "viewConfig",
                                "type": "object"
                            },
                            "codeClass": null,
                            "designerId": "a4c3a9fe-3dc1-47eb-9ddc-669140c90f62",
                            "cn": [
                                {
                                    "type": "Ext.grid.plugin.DragDrop",
                                    "reference": {
                                        "name": "plugins",
                                        "type": "array"
                                    },
                                    "codeClass": "Ext.grid.plugin.DragDrop",
                                    "designerId": "c7f29566-6e0e-43e4-9f90-4cffa8424c2d"
                                }
                            ]
                        },
                        {
                            "type": "Ext.grid.column.Column",
                            "reference": {
                                "name": "columns",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "localiserId": "optionsCol",
                                "height": null,
                                "dataIndex": "boxLabel",
                                "text": "Options"
                            },
                            "designerId": "d2f25f9f-663c-40a4-a5ef-5168fb3532af",
                            "customConfigs": [
                                {
                                    "group": "(Custom Properties)",
                                    "name": "localiserId",
                                    "type": "string"
                                }
                            ],
                            "cn": [
                                {
                                    "type": "Ext.form.field.Text",
                                    "reference": {
                                        "name": "editor",
                                        "type": "object"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "allowBlank": false
                                    },
                                    "designerId": "44e18556-7463-4808-8fd0-847098f0a2ae"
                                }
                            ]
                        },
                        {
                            "type": "Ext.toolbar.Toolbar",
                            "reference": {
                                "name": "dockedItems",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "dock": "right",
                                "width": 28
                            },
                            "designerId": "d340b82b-16e1-4c62-a1b0-9eabaef82e0b",
                            "cn": [
                                {
                                    "type": "Ext.button.Button",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "layout|flex": null,
                                        "localiserId": "closedQuestionAddOptionBtn",
                                        "id": "formsMCCGridAdd",
                                        "iconCls": "add",
                                        "text": "",
                                        "tooltip": "Ajouter une option"
                                    },
                                    "configAlternates": {
                                        "tooltip": "string"
                                    },
                                    "designerId": "9520bce1-decf-475c-8a50-c033d6d9fbb6",
                                    "customConfigs": [
                                        {
                                            "group": "(Custom Properties)",
                                            "name": "localiserId",
                                            "type": "string"
                                        }
                                    ],
                                    "cn": [
                                        {
                                            "type": "fixedfunction",
                                            "reference": {
                                                "name": "items",
                                                "type": "array"
                                            },
                                            "codeClass": null,
                                            "userConfig": {
                                                "fn": "handler",
                                                "designer|params": [
                                                    "button",
                                                    "event"
                                                ],
                                                "implHandler": [
                                                    "Ext.Ajax.request({\r",
                                                    "    url: 'xhr-get-mongo-id',\r",
                                                    "    params: { },\r",
                                                    "    success: function(response){\r",
                                                    "        var servedId = Ext.JSON.decode(response.responseText).mongoID;\r",
                                                    "        Ext.getStore(\"MultiChoiceOptionsStore\").add({\r",
                                                    "            inputValue:servedId,\r",
                                                    "            name:Ext.getCmp(\"MultiChoiceConfigurator\").targetedId,\r",
                                                    "            boxLabel:\"Option \"+ (Ext.getStore(\"MultiChoiceOptionsStore\").count()+1)\r",
                                                    "        });\r",
                                                    "    },\r",
                                                    "    failure: function(){\r",
                                                    "        Ext.Msg.alert(Rubedo.RubedoAutomatedElementsLoc.errorTitle, Rubedo.RubedoAutomatedElementsLoc.identifierRecoverError);\r",
                                                    "\r",
                                                    "    }\r",
                                                    "});"
                                                ]
                                            },
                                            "designerId": "985357c2-a346-4dd6-80cd-a97856fa1e0e"
                                        }
                                    ]
                                },
                                {
                                    "type": "Ext.button.Button",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "layout|flex": null,
                                        "localiserId": "closedQuestionRemoveOptionBtn",
                                        "disabled": true,
                                        "id": "formsMCCGridRemove",
                                        "iconCls": "close",
                                        "text": "",
                                        "tooltip": "Supprimer cette option"
                                    },
                                    "configAlternates": {
                                        "tooltip": "string"
                                    },
                                    "designerId": "0e28d65f-bc6c-40a8-acdc-f9ace9d581eb",
                                    "customConfigs": [
                                        {
                                            "group": "(Custom Properties)",
                                            "name": "localiserId",
                                            "type": "string"
                                        }
                                    ],
                                    "cn": [
                                        {
                                            "type": "fixedfunction",
                                            "reference": {
                                                "name": "items",
                                                "type": "array"
                                            },
                                            "codeClass": null,
                                            "userConfig": {
                                                "fn": "handler",
                                                "designer|params": [
                                                    "button",
                                                    "event"
                                                ],
                                                "implHandler": [
                                                    "Ext.getCmp(\"formsMCCGrid\").getStore().remove(Ext.getCmp(\"formsMCCGrid\").getSelectionModel().getLastSelected());"
                                                ]
                                            },
                                            "designerId": "05f9a4dd-1539-42a2-a1fe-9b378e273e47"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "Ext.grid.plugin.CellEditing",
                            "reference": {
                                "name": "plugins",
                                "type": "array"
                            },
                            "codeClass": "Ext.grid.plugin.CellEditing",
                            "designerId": "09e9564c-efeb-426b-855e-007a2e5dcb1a"
                        },
                        {
                            "type": "basiceventbinding",
                            "reference": {
                                "name": "listeners",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "fn": "onFormsMCCGridSelectionChange",
                                "implHandler": [
                                    "if (Ext.isEmpty(selected)){\r",
                                    "    Ext.getCmp(\"formsMCCGridRemove\").disable();\r",
                                    "} else {\r",
                                    "    Ext.getCmp(\"formsMCCGridRemove\").enable();\r",
                                    "}"
                                ],
                                "name": "selectionchange",
                                "scope": "me"
                            },
                            "designerId": "136dfccb-1300-4acf-b2c1-1b0e40603e3b"
                        }
                    ]
                }
            ]
        },
        {
            "type": "basiceventbinding",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "onWindowAfterRender",
                "implHandler": [
                    "var initialValues = Ext.clone(component.initialItemConfig.fieldConfig);\r",
                    "initialValues.fieldType= Ext.clone(component.initialItemConfig.fieldType);\r",
                    "Ext.getStore(\"MultiChoiceOptionsStore\").removeAll();\r",
                    "Ext.getStore(\"MultiChoiceOptionsStore\").loadData(Ext.clone(initialValues.items));\r",
                    "initialValues.fieldLabel=Ext.clone(component.initialItemConfig.label);\r",
                    "initialValues.tooltip=Ext.clone(component.initialItemConfig.tooltip);\r",
                    "initialValues.qNb=Ext.clone(component.initialItemConfig.qNb);\r",
                    "delete initialValues.items;\r",
                    "delete initialValues.vertical;\r",
                    "component.getComponent(0).getForm().setValues(initialValues);"
                ],
                "name": "afterrender",
                "scope": "me"
            },
            "designerId": "41e5ac8d-d725-4ff5-aa21-859820333d6d"
        }
    ]
}